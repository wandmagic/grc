{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Vulnerability Node",
  "description": "A node representing a vulnerability in a GRC model",
  "type": "object",
  "allOf": [
    {
      "$ref": "../node.schema.json#/definitions/node"
    },
    {
      "properties": {
        "type": {
          "const": "vulnerability"
        },
        "name": {
          "type": "string",
          "description": "Name of the vulnerability"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the vulnerability"
        },
        "vulnerabilityId": {
          "type": "string",
          "description": "Identifier for the vulnerability (e.g., CVE ID)"
        },
        "category": {
          "type": "string",
          "description": "Category of the vulnerability",
          "enum": ["software", "hardware", "network", "physical", "personnel", "process", "other"]
        },
        "severity": {
          "type": "string",
          "description": "Severity level of the vulnerability",
          "enum": ["critical", "high", "medium", "low", "info"]
        },
        "cvssScore": {
          "type": "number",
          "description": "CVSS score of the vulnerability",
          "minimum": 0,
          "maximum": 10
        },
        "status": {
          "type": "string",
          "description": "Current status of the vulnerability",
          "enum": ["identified", "confirmed", "remediated", "mitigated", "accepted", "false-positive"]
        },
        "discoveryDate": {
          "type": "string",
          "format": "date",
          "description": "Date when the vulnerability was discovered"
        },
        "publishedDate": {
          "type": "string",
          "format": "date",
          "description": "Date when the vulnerability was published"
        },
        "remediationDueDate": {
          "type": "string",
          "format": "date",
          "description": "Due date for remediation of the vulnerability"
        },
        "exploitability": {
          "type": "string",
          "description": "Exploitability assessment of the vulnerability",
          "enum": ["unproven", "proof-of-concept", "functional", "high", "not-defined"]
        },
        "remediationComplexity": {
          "type": "string",
          "description": "Complexity of remediation",
          "enum": ["low", "medium", "high"]
        },
        "remediationSteps": {
          "type": "string",
          "description": "Steps to remediate the vulnerability"
        },
        "affectedComponents": {
          "type": "array",
          "description": "Components affected by the vulnerability",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["name", "description", "severity", "status"]
    }
  ],
  "$id": "vulnerability.schema.json"
}
